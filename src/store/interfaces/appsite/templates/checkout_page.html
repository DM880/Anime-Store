{% extends 'base.html' %}
{% load static %}
{% block title %}{% if request.user.is_authenticated %}
                {{ request.user.username }}
                {% else %}
                Guest
                {% endif %}
                Checkout{% endblock %}

{% block css %}<link rel="stylesheet" href="{% static 'css/checkout_page.css' %}">{% endblock %}

{% block content %}

<div class="wrapper">

<table class="spacing-table">
  <tr style="border-bottom: 1px solid #000;">
    <th>
      <h5>Item Details</h5>
    </th>
    <th>
    </th>
    <th>
      <h5>Price</h5>
    </th>
    <th>
      <h5 style="margin-left:10px;">Quantity</h5>
    </th>
    <th>
    </th>
    <th>
    </th>
  </tr>
    {% for item in items %}

   <tr style="border-bottom: 1px solid #000;">
    <td>
      <div class="itm-img"><img src="/media/{{ item.item.first_image.image }}"></div>
    </td>
    <td><div class="itm-name"><p>{{ item.item.name }}</p>
    </td>
    <td>
      <div class="price-div"><p>${{ item.total_price }}</p></div>
    </td>
    <td>
      <div class="quantity-cont">
        <form method="POST" action="{% url 'checkout_update_quantity' entry=item.id %}">
          {% csrf_token %}
    <button type="button" id="minus" class="plus-minus btn btn-danger" onclick="decrementValue({{item.id}})" title="Remove From Cart">-</button>
    <input id="quantity{{item.id}}" class="quantity"  value="{{ item.quantity }}" name="quantity" readonly></input>
    <button type="button" id="plus" class="plus-minus btn btn-danger" onclick="incrementValue({{item.id}})" title="Add To Cart">+</button>
    </div>
    </td>
    <td>
       <div class="btn-update"><button type="submit" class="btn btn-outline-success" title="Update Quantity" style="margin-left:100px;">UPDATE</div>
  </form>
    </td>
     <td>
      <div>
      <a class="delete-itm" id="delete-entry{{item.id}}" data-id="{{item.id}}" href="{% url 'checkout_remove_entry' entry=item.id %}" title="Delete Entry">X</a>
      </div>
  </div>
     </td>
  </tr>
  {% endfor %}

</table>
  <hr>

</div>

<div class="tot" style="float:right; margin:20px 100px 50px auto;"><p>Subtotal ${{ subtotal }}</p>
  <br>
       <p>Delivery $4.99</p>
  <hr>
  <h5>Total<span style="font-size:12px;">(include GST)</span> ${{ total|floatformat:2 }}</h5>
    <a href=""><button class="btn btn-success" style="margin-top:20px;margin-left:30px;" title="Checkout">Checkout</button></a>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<script  src="{% static 'js/checkout_page.js' %}"></script>

{% endblock %}